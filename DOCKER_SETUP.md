# Настройка подключения к Docker бэкенду

## Вариант 1: Использование прокси Vite (Рекомендуется)

Этот вариант проще и не требует настройки CORS на бэкенде.

### Шаги:

1. **Создайте файл `.env` в корне проекта:**

```env
# Оставьте VITE_API_BASE_URL пустым или не указывайте его
# VITE_API_BASE_URL=

# Укажите адрес вашего Docker контейнера
VITE_PROXY_TARGET=https://172.19.0.2:54367
```

2. **Запустите dev сервер:**

```bash
npm run dev
```

Vite автоматически будет проксировать все запросы к `/api`, `/threads`, `/comments`, `/profile` на ваш Docker контейнер.

### Преимущества:
- ✅ Не нужно настраивать CORS
- ✅ Не нужно беспокоиться о SSL сертификатах
- ✅ Проще переключаться между окружениями

---

## Вариант 2: Прямые запросы к Docker

Если вы хотите отправлять запросы напрямую к Docker контейнеру.

### Шаги:

1. **Создайте файл `.env`:**

```env
# Укажите полный URL вашего Docker контейнера
VITE_API_BASE_URL=https://172.19.0.2:54367

# Или для HTTP:
# VITE_API_BASE_URL=http://172.19.0.2:54367
```

2. **Убедитесь, что на бэкенде настроен CORS:**

Бэкенд должен разрешать запросы с вашего фронтенда. В документации указано, что CORS настроен для:
- `https://localhost:24815`
- `http://localhost:24815`

Если ваш фронтенд работает на другом адресе, добавьте его в настройки CORS на бэкенде.

3. **Для HTTPS с самоподписанными сертификатами:**

Браузер может блокировать запросы к самоподписанным сертификатам. В этом случае:
- Используйте HTTP вместо HTTPS
- Или добавьте исключение для сертификата в браузере

---

## Проверка подключения

После настройки откройте консоль браузера (F12) и проверьте:

1. **Запросы отправляются правильно:**
   - В Network tab должны быть запросы к API
   - Статус должен быть 200 или другой успешный

2. **Ошибки CORS:**
   - Если видите ошибки типа "CORS policy", используйте Вариант 1 (прокси)
   - Или настройте CORS на бэкенде

3. **Ошибки SSL:**
   - Если видите ошибки SSL, переключитесь на HTTP
   - Или используйте прокси (Вариант 1)

---

## Определение адреса Docker контейнера

Чтобы узнать адрес вашего Docker контейнера:

```bash
# Список всех контейнеров
docker ps

# Информация о конкретном контейнере
docker inspect <container_name>

# Или используйте имя сервиса из docker-compose.yml
# Например: http://commentapi:5000 (внутри Docker сети)
```

**Важно:** 
- Если фронтенд и бэкенд в одной Docker сети, используйте имя сервиса
- Если фронтенд на хосте, используйте `localhost` или IP контейнера
- Для доступа с хоста используйте проброшенные порты

---

## Примеры конфигурации

### Docker Compose (если фронтенд тоже в Docker):

```yaml
services:
  frontend:
    # ...
    environment:
      - VITE_API_BASE_URL=http://backend:5000
    depends_on:
      - backend
  
  backend:
    # ...
    ports:
      - "5000:5000"
```

### Локальная разработка:

```env
# .env
VITE_PROXY_TARGET=http://localhost:5000
```

### Production:

```env
# .env.production
VITE_API_BASE_URL=https://api.yourdomain.com
```

